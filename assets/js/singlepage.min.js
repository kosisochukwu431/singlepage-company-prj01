/* Template: ABC Learning Centre (WDD Module - ASSIGNMENT)
   Author: Lim Yao Cheng
   Created: 2020
   Description: Custom JS - Single Page Application & Form Validation

Table Of Contents:

01. Variable Initialization
02. Once Document is Ready to Performed $(document).ready(function(){})
03. Check URL () and load the SPA (home, about, contact...)
04. loadPage () - Load Page like 'home', 'about', 'contact', 'privacy-policy', 'register'
05. loadCourse () - Load Page like 'course-html-css-page01' ... all course details and course schedules page
06. loadMessage () - Load Page like 'thank-you.php' and
retrieve data from database and display together with thank you message.
07. loadjscssfile () - JAVASCRIPT & CSS FILE to Header 
08 - Form Validation - Validate when an event fire or onSubmit
*/
var default_content="",home_title="ABC Learning Centre",lastCourse="",lastUrl="";function checkURL(e){e||(e=window.location.hash),url=e.slice(0,7),e==lastUrl&&url==lastCourse||(lastUrl=e,lastCourse=url,""==e?(document.title=home_title,$("#pageContent").html(default_content)):"#courses-offered"==e?loadPage(e):"#thank-you"==e?loadMessage(e):"#course"==url?loadCourses(e):loadPage(e))}function loadPage(e){e=e.replace("#",""),search=window.location.search,title=e.replace(/-/g," "),$.ajax({type:"POST",url:"load-page.php",data:"page="+e,dataType:"html",success:function(e){0!=parseInt(e)&&(loadjscssfile("assets/css/menu.min.css","css"),document.title=(title+" | "+home_title).toUpperCase(),$("#pageContent").html(e),window.location.search.includes(search)&&validation())}})}function loadCourses(e){e=e.replace("#course-",""),title=e.replace(/-/g," "),$.ajax({type:"POST",url:"load-course.php",data:"course="+e,dataType:"html",success:function(e){loadjscssfile("assets/css/menu.min.css","css"),loadjscssfile("assets/js/vendor/jquery-ui.min.js","js"),loadjscssfile("assets/css/vendor/jquery-ui.min.css","css"),loadjscssfile("assets/js/tabmenu.js","js"),0!=parseInt(e)&&(document.title=(title+" | "+home_title).toUpperCase(),$("#pageContent").html(e),$("#loading").css("visibility","hidden"))}})}function loadMessage(e){e=e.replace("#",""),title=e.replace(/-/g," "),$("#loading").css("visibility","visible"),search=window.location.search,$.ajax({url:"load-message.php",method:"GET",data:"page="+e,success:function(e){$.ajax({url:"thank-you.php",method:"GET",dataType:"JSON",success:function(e){0!=parseInt(e)&&(loadjscssfile("assets/css/menu.min.css","css"),document.title=(title+" | "+home_title).toUpperCase(),$("#pageContent").html("<h1>Form Submitted Successfully</h1>\t\t\t\t\t\t<p> Dear <strong>"+e.fname+"  "+e.lname+"</strong>,</p>\t\t\t\t\t\t<p>Thank You for your registration!!!\t\t\t\t\t\t<br>\t\t\t\t\t\tCourse detail have been sent to your email address (<strong> "+e.email+" ) <strong></p>"),$("#loading").css("visibility","hidden"))}})}})}function loadjscssfile(e,r){if("js"==r)(n=document.createElement("script")).setAttribute("type","text/javascript"),n.setAttribute("src",e);else if("css"==r){var n;(n=document.createElement("link")).setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",e)}void 0!==n&&document.getElementsByTagName("head")[0].appendChild(n)}function checkBlank(e){return""==document.getElementById(e).value}function blankErrorMsg(e,r){checkBlank(e)?randomeErrorMsg(r,"Please fill in this fill"):randomeErrorMsg(r,"")}function checkalpha(e){return e.which>=65&&e.which<=90||e.which>=97&&e.which<=122||0==e.which||8==e.which||32==e.which||(e.preventDefault(),!1)}function alphaErrorMsg(e){randomeErrorMsg(e,"Invalid Name Format. Please enter only alphabet.")}function checkNum(e){return e.which>=48&&e.which<=57||8==e.which||(e.preventDefault(),!1)}function numErrorMsg(e){randomeErrorMsg(e,"Invalid Number Format. Please enter only number.")}function checkEmail(e){var r=document.getElementById(e).value;return!!/^\w+([\.-]?\w+)+@\w+\.\w{2,3}(\.\w{2})?$/g.test(r)}function emailPrintMsg(e){randomeErrorMsg(e,"Email must be valid form. xxx@xxxxx.xxx or xxx@xxxxx.xxx.xx")}function checkPhoneLength(e){var r=document.getElementById(e).value;return!!/^\d{10,11}$/g.test(r)}function phoneLengthErrorMsg(e){randomeErrorMsg(e,"Please enter minimum 10 digits maximum 11 digits.")}function checkPasswordLength(e){var r=document.getElementById(e).value;return!!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{12}$/g.test(r)}function passwordLengthErrorMsg(e){randomeErrorMsg(e,"Please enter 12 characters. At least 1 number, 1 lowercase and 1 uppercase letter")}function randomeErrorMsg(e,r){document.getElementById(e).innerHTML=r}function validation(){var e="";$("#password").keydown(function(){checkPasswordLength("password")?randomeErrorMsg("error-password",""):passwordLengthErrorMsg("error-password")}),$("#password").keyup(function(){checkPasswordLength("password")?randomeErrorMsg("error-password",""):passwordLengthErrorMsg("error-password")}),$("#phone").keydown(function(e){checkNum(e)?checkPhoneLength("phone")?randomeErrorMsg("error-phone",""):phoneLengthErrorMsg("error-phone"):numErrorMsg("error-phone")}),$("#phone").keyup(function(e){checkNum(e)?checkPhoneLength("phone")?randomeErrorMsg("error-phone",""):phoneLengthErrorMsg("error-phone"):numErrorMsg("error-phone")}),$("#email").keydown(function(){checkEmail("email")?randomeErrorMsg("error-email",""):emailPrintMsg("error-email")}),$("#email").keyup(function(){checkEmail("email")?randomeErrorMsg("error-email",""):emailPrintMsg("error-email")}),$("#fname").keydown(function(e){checkalpha(e)?randomeErrorMsg("error-fname",""):alphaErrorMsg("error-fname")}),$("#lname").keydown(function(e){checkalpha(e)?randomeErrorMsg("error-lname",""):alphaErrorMsg("error-lname")}),$("#name").keydown(function(e){checkalpha(e)?randomeErrorMsg("error-name",""):alphaErrorMsg("error-name")}),$("#submit").click(function(){if(checkBlank("fname")||checkBlank("lname")||checkBlank("phone")||checkBlank("email")||checkBlank("password")||checkBlank("fcourse"))blankErrorMsg("fname","error-fname"),blankErrorMsg("lname","error-lname"),blankErrorMsg("phone","error-phone"),blankErrorMsg("email","error-email"),blankErrorMsg("password","error-password"),blankErrorMsg("fcourse","error-course"),checkEmail("email")||emailPrintMsg("error-email"),checkPhoneLength("phone")||phoneLengthErrorMsg("error-phone"),checkPasswordLength("password")||passwordLengthErrorMsg("error-password");else{var r=$("#fname").val(),n=$("#lname").val(),a=$("#phone").val(),t=$("#email").val(),o=$("#password").val(),s=$("#fcourse").val();e="fname="+r+"&lname="+n+"&phone="+a+"&email="+t+"&password="+o+"&fcourse="+s,$.ajax({type:"POST",url:"register-process.php",data:e,cache:!1}),window.location.replace("#thank-you")}return!1})}$(document).ready(function(){checkURL(),$("nav ul li a").click(function(e){hash=window.location.hash,checkURL(hash)}),default_content=$("#pageContent").html(),setInterval("checkURL()")});